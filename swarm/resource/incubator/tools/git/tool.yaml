#!/usr/bin/env ai
#
# Tool: git/*
#
# Run safe git actions using pure Go (go-git/v5).
# 12 core operations as distinct tools: git_status, git_diff_unstaged, git_diff_staged, git_diff, git_commit, git_add, git_reset, git_log, git_create_branch, git_checkout, git_show, git_branches.
#
kit: "git"
tools:
  - name: "git_status"
    description: |
      Get working tree status like `git status --porcelain`.
    type: "system"
    parameters:
      type: "object"
      properties:
        dir:
          type: "string"
          description: "Path to the git repository."
      required: []
  - name: "git_diff_unstaged"
    description: |
      Show unstaged changes (working tree vs index) in unified diff format.
    type: "system"
    parameters:
      type: "object"
      properties:
        dir:
          type: "string"
        context_lines:
          type: "integer"
          default: 3
      required: []
  - name: "git_diff_staged"
    description: |
      Show staged changes (index vs HEAD) in unified diff format.
    type: "system"
    parameters:
      type: "object"
      properties:
        dir:
          type: "string"
        context_lines:
          type: "integer"
          default: 3
      required: []
  - name: "git_diff"
    description: |
      Show diff against a target branch or commit.
    type: "system"
    parameters:
      type: "object"
      properties:
        dir:
          type: "string"
        target:
          type: "string"
          description: "Target branch, commit hash, or ref."
        context_lines:
          type: "integer"
          default: 3
      required: ["target"]
  - name: "git_commit"
    description: |
      Commit staged changes with a message.
    type: "system"
    parameters:
      type: "object"
      properties:
        dir:
          type: "string"
        message:
          type: "string"
        args:
          type: "array"
          items:
            type: "string"
          description: "Additional args e.g. [&quot;-c&quot;, &quot;user.name=foo&quot;]"
      required: ["message"]
  - name: "git_add"
    description: |
      Stage files for commit.
    type: "system"
    parameters:
      type: "object"
      properties:
        dir:
          type: "string"
        files:
          type: "array"
          items:
            type: "string"
      required: ["files"]
  - name: "git_reset"
    description: |
      Unstage all changes (mixed reset).
    type: "system"
    parameters:
      type: "object"
      properties:
        dir:
          type: "string"
      required: []
  - name: "git_log"
    description: |
      Get recent commits as JSON array [{hash, author, date, message}].
    type: "system"
    parameters:
      type: "object"
      properties:
        dir:
          type: "string"
        max_count:
          type: "integer"
        start_timestamp:
          type: "string"
        end_timestamp:
          type: "string"
      required: []
  - name: "git_create_branch"
    description: |
      Create a new branch from current or base_branch.
    type: "system"
    parameters:
      type: "object"
      properties:
        dir:
          type: "string"
        branch_name:
          type: "string"
        base_branch:
          type: "string"
      required: ["branch_name"]
  - name: "git_checkout"
    description: |
      Switch to a branch.
    type: "system"
    parameters:
      type: "object"
      properties:
        dir:
          type: "string"
        branch_name:
          type: "string"
      required: ["branch_name"]
  - name: "git_show"
    description: |
      Show commit details and changes vs parent.
    type: "system"
    parameters:
      type: "object"
      properties:
        dir:
          type: "string"
        rev:
          type: "string"
      required: ["rev"]
  - name: "git_branches"
    description: |
      List branches as JSON array. branch_type: local (default), remote, all.
    type: "system"
    parameters:
      type: "object"
      properties:
        dir:
          type: "string"
        branch_type:
          type: "string"
          enum: ["local", "remote", "all"]
      required: []
