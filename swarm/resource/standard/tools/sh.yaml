###
kit: "sh"
type: "system"

tools:
  - name: "help"
    display: "Shell Tool Help"
    description: |
      A set of tools for executing agent, tool, system command actions
      and applying templates.
    parameters: {}
    type: "func"
    body:
      mime_type: "text/x-go-template"
      script: |
        #!
        A set of tools for executing agent, tool, system command actions
        and applying templates.

        ## Actions
          + bash
          + exec
          + format
          + parse

        ## Templates
          + apply
    log_level: "quiet"

  - name: "pass"
    description: |
      A no-operation (no-op) tool that performs no actions. 
      Ideal for scenarios requiring a placeholder or testing phase 
      where subsequent processes are needed without executing any specific tasks.
    parameters: {}

  - name: "exec"
    description: |
      Execute a specified command within the user's environment.
      Ensure the command is specified as a command line string. Security restrictions may apply.
    parameters:
      type: "object"
      properties:
        command:
          type: "string"
          description: "The command to execute as a command line string."
      required:
        - command

  - name: "cd"
    description: |
      *Unsupported Command*: Changing the current working directory isn't supported on the user's system. 
      You must use absolute path for accessing directories and files. 
      Run 'fs:list_roots' tool to identify allowed top-level directories.
    parameters: {}

  - name: "pwd"
    description: "Print the current working directory on user's system."
    parameters: {}

  - name: "bash"
    description: |
      Executes a shell script within the user's environment.
      The script can be a file path or inline with the "data:" prefix.
      Note: security restrictions may apply.
    parameters:
      type: "object"
      properties:
        script:
          type: "string"
          description: |
            Path to the script file or inline script prefixed with 'data:'.
      required:
        - script

  - name: "apply"
    description: |
      Applies a Golang template to provided data, as documented at: https://pkg.go.dev/text/template.
      The template can be specified either as a file path or as an inline string prefixed with "data:".
      Additional arguments represent the data to be used in the template. Some default data variables include:
      + query - the user's request message
      + result - the last LLM's response
      + error - any errors encountered during processing
      Additional environment variables are also available and can be inspected using the ai:get_envs tool call.
    parameters:
      type: "object"
      properties:
        template:
          type: "string"
          description: |
            Specifies the template to be applied to the data.
            It can be specified either as a file path or as an inline string prefixed with "data:".
            Provide any additional arguments required by the template.
      required:
        - template

  - name: "format"
    description: |
      Specifies the format or a custom template for the output.
    parameters:
      type: "object"
      properties:
        output:
          type: "string"
          description: |
            The destination for the formatted output. Defaults to the console.
            Accepts a URI. Currently supported scheme: "file:"
        template:
          type: "string"
          description: |
            A custom template to apply to the data. If not provided, default templates
            are used based on the format: json, markdown, or raw.
            It can be a file path or an inline string prefixed with "data:".

  - name: "parse"
    description: |
      Parses an input command line into a `map[string]any` format and validate.
    parameters:
      type: "object"
      properties:
        command:
          type: "string"
          description: |
            Specifies the command line to be parsed.
      required:
        - command

  - name: "timeout"
    description: |
      Run action with a time limit.
      An action could be a system command, a tool, or an agent.
    parameters:
      type: "object"
      properties:
        command:
          type: "string"
          description: |
            The action with arguements to run.
            Format:
              ACTION [OPTIONS] ... 
            Example:
              timeout /bin/ls
              timeout /sh:bash --script "data:,#!\n/bin/ls /tmp"
              timeout /agent:joker --message "tell me a joke"

            Start the action with options, and cancel it if still running after the specified duration.
        duration:
          type: "string"
          description: |
            Duration is a number with an optional suffix: 's'
            for seconds (the default), 'm' for minutes, 'h' for hours, or 'd'
            for days.  
            A duration of 0 disables the associated timeout.
      required:
        - command

  - name: "backoff"
    description: |
      Run a command, repeatedly, until it succeeds or we are out of time.
    parameters:
      type: "object"
      properties:
        command:
          type: "string"
          description: |
            The action with arguements to run.
        duration:
          type: "string"
          description: |
            Duration is a number with an optional suffix: 's'
            for seconds (the default), 'm' for minutes, 'h' for hours, or 'd'
            for days.
      required:
        - command

  - name: "get_envs"
    description: "Get specific or all environment variables"
    parameters:
      type: "object"
      properties:
        keys:
          type: "array"
          description: "An array of environment variable names to retrieve. If not provided, all environment variables will be returned"
          items:
            type: "string"

  - name: "set_envs"
    description: "Set environment variables."
    parameters:
      type: "object"
      properties:
        envs:
          type: "object"
          description: |
            A JSON object map of environment variables, represented as key-value pairs.
            Each key is a string, and the value can be any data type, including objects and primitive types.
            Ensure to provide at least one key-value pair to prevent empty calls. 
            For example, to set environment variables foo and bar, pass: {"foo": "value1", "bar": "value2"}.
          properties: {}
      required:
        - "envs"

  - name: "unset_envs"
    description: "Clear environment variables"
    parameters:
      type: "object"
      properties:
        keys:
          type: "array"
          description: "An array of environment variable names to unset."
          items:
            type: "string"
      required:
        - "keys"
