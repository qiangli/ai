#!/usr/bin/env ai
#
# Tool: sh:git
#
# It is intentionally strict: it only accepts structured actions or a command
# array that starts with "git".
#
# Runtime notes:
# - Default uses `go run` from the workspace root.
# - No static binaries are checked in. (You may build one locally if desired.)
#
kit: "sh"
tools:
  - name: "git"
    description: "Run safe git actions."
    # type: "func"
    parameters:
      type: "object"
      properties:
        # id: { type: "string", description: "Optional request id." }
        # user: { type: "string", description: "Optional user label." }
        payload:
          type: "object"
          description: "Payload object passed to git. If omitted, tool will build it from top-level fields for backward compat."
          properties:
            action:
              type: "string"
              enum:
                [
                  "status",
                  "clone",
                  "commit",
                  "pull",
                  "push",
                  "branch",
                  "remote-url",
                  "rev-parse",
                  "list-branches",
                  "list-remotes",
                  "latest-commit",
                  "show-file",
                  "raw",
                ]
            dir: { type: "string" }
            args: { type: "array", items: { type: "string" } }
            message: { type: "string" }
            rev: { type: "string" }
            path: { type: "string" }
            command:
              type: "array"
              items: { type: "string" }
              description: "Raw git argv array; must start with 'git'."
        # Backward-compat convenience fields:
        action:
          type: "string"
          enum:
            [
              "status",
              "clone",
              "commit",
              "pull",
              "push",
              "branch",
              "remote-url",
              "rev-parse",
              "list-branches",
              "list-remotes",
              "latest-commit",
              "show-file",
              "raw",
            ]
        dir: { type: "string" }
        args:
          type: "array"
          items: { type: "string" }
        message: { type: "string" }
        rev: { type: "string" }
        path: { type: "string" }
        command:
          type: "array"
          items: { type: "string" }
      required: []
