###
kit: "sh"
type: "system"

tools:
  - name: "help"
    display: "Shell Tool Help"
    description: |
      A set of tools for executing agent, tool, system command actions
      and applying templates.
    parameters: {}
    type: "func"
    body:
      language: "template"
      code: |
        #!
        A set of tools for executing agent, tool, system command actions
        and applying templates.

        ## Actions
          + bash
          + exec
          + format
          + parse

        ## Templates
          + apply
      # language: "golang"
      # code: |
      #   import "fmt"
      #   const desc = `
      #   A set of tools for executing agent, tool, system command actions
      #   and applying templates.

      #   ## Actions
      #     + bash
      #     + exec
      #     + format
      #     + parse

      #   ## Templates
      #     + apply
      #   `
      #   func main() {
      #     fmt.Printf(desc)
      #   }
    log_level: "quiet"

  - name: "pass"
    description: |
      A no-operation (no-op) tool that performs no actions. 
      Ideal for scenarios requiring a placeholder or testing phase 
      where subsequent processes are needed without executing any specific tasks.
    parameters: {}

  - name: "exec"
    description: |
      Execute a specified command within the user's environment.
      Note: Ensure the command is specified as a command line string. Security restrictions may apply.
    parameters:
      type: "object"
      properties:
        command:
          type: "string"
          description: "The command to execute as a command line string."

      required:
        - command

  # - name: "cd"
  #   description: "Change the current working directory on user's system."
  #   parameters:
  #     type: "object"
  #     properties:
  #       dir:
  #         type: "string"
  #         description: "The directory to change to."
  #     required:
  #       - dir

  # - name: "pwd"
  #   description: "Print the current working directory on user's system."
  #   parameters: {}

  - name: "flow"
    description: |
      Execute a specified list of actions within the user's environment.
      Ensure that the actions are provided as an array, keeping in mind any security restrictions.
    parameters:
      type: "object"
      properties:
        flow_type:
          type: "string"
          description: |
            Defines how the actions in the flow are executed. Supported types include:
            + sequence: Execute actions consecutively, using the result of each action as the input for the next one.
            + choice: Randomly select and execute a single action from the list.
            + parallel: Execute all actions simultaneously and return their results as a combined list.
            + map: Apply the specified actions to each item in the input array, producing a new array. Actions are executed in sequence for each array element.
        query:
          type: "string"
          description: "The input query string"
        actions:
          type: "array"
          items:
            type: "string"
          description: |
            A list of valid actions. Use `ai:list_tools` or `ai:list_agents` to acquire available actions.
            Specify actions in the following formats:
            - Tool action: `tool:kit:name`
            - Agent action: `agent:pack/name`

            Example for tool: `fs:read_file`
            Examples for agent: `agent:ask`, `agent:memory/lastn`
            Note: `fs:read_file` should be from the list obtained using list_tools, 
            while `agent:ask` and `agent:memory/lastn` should be from list_agents.

            Additional arguments may be required for each action.
            To explore the required arguments and further specifics of an action,
            use "ai:get_agent_info" for agents or "ai:get_tool_info" for tools.
            This will provide detailed information about the parameters and usage guidelines.
      required:
        - actions

  - name: "bash"
    description: |
      Executes a shell script within the user's environment.
      The script can be a file path or inline with the "data:" prefix.
      Note: security restrictions may apply.
    parameters:
      type: "object"
      properties:
        script:
          type: "string"
          description: |
            Path to the script file or inline script prefixed with 'data:'.
      required:
        - script

  - name: "apply"
    description: |
      Applies a Golang template to provided data, as documented at: https://pkg.go.dev/text/template.
      The template can be specified either as a file path or as an inline string prefixed with "data:".
      Additional arguments represent the data to be used in the template. Some default data variables include:
      + query - the user's request message
      + result - the last LLM's response
      + error - any errors encountered during processing
      Additional environment variables are also available and can be inspected using the ai:get_envs tool call.
    parameters:
      type: "object"
      properties:
        template:
          type: "string"
          description: |
            Specifies the template to be applied to the data.
            It can be specified either as a file path or as an inline string prefixed with "data:".
            Provide any additional arguments required by the template.
      required:
        - template

  - name: "format"
    description: |
      Specifies the format or a custom template for the output.
    parameters:
      type: "object"
      properties:
        output:
          type: "string"
          description: |
            The destination for the formatted output. Defaults to the console.
            Accepts a URI. Currently supported scheme: file:
        template:
          type: "string"
          description: |
            A custom template to apply to the data. If not provided, default templates
            are used based on the format: json, markdown, or raw.
            It can be a file path or an inline string prefixed with "data:".

  - name: "parse"
    description: |
      Parses an input command line into a `map[string]any` format and validate.
    parameters:
      type: "object"
      properties:
        command:
          type: "string"
          description: |
            Specifies the command line to be parsed.
      required:
        - command
  
  - name: "timeout"
    description: |
      Run action with a time limit.
      An action could be a system command, a tool, or an agent.
    parameters:
      type: "object"
      properties:
        command:
          type: "string"
          description: |
            The action with arguements to run.
            Format:
              ACTION [OPTIONS] ... 
            Example:
              timeout /bin/ls
              timeout /sh:bash --script "data:,#!\n/bin/ls /tmp"
              timeout /agent:joker --message "tell me a joke"
            
            Start the action with options, and cancel it if still running after the specified duration.
        duration:
          type: "string"
          description: |
            Duration is a number with an optional suffix: 's'
            for seconds (the default), 'm' for minutes, 'h' for hours, or 'd'
            for days.  
            A duration of 0 disables the associated timeout.
      required:
        - command
