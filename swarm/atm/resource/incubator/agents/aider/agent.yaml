###
# https://github.com/Aider-AI/aider
# https://aider.chat/docs/usage/modes.html
pack: "aider"
log_level: "info"
max_time: 900
max_turns: 100
agents:
  - name: "aider"
    display: "Aider"
    description: |
      Aider lets you pair program with LLMs to start a new project or build on your existing codebase.
      Act as an expert code analyst and answer questions about the supplied code
      Act as an expert architect engineer and provide direction to your editor engineer.
    model: "llm/L1"
    environment:
      language: "go"
    embed:
      - agent:aider/detect_lang
    instruction: |
      Always prioritize task delegation to the appropriate sub-agent based on the specific task context:
      - Use "agent:aider/ask" for discussing and answering questions about code without making changes.
      - Use "agent:aider/code" for implementing code changes based on user requests.
      - Use "agent:aider/architect" for architectural advice and modifications.

      For more details on sub-agents, refer to "ai:get_agent_info" tool call.
    functions:
      - "fs:*"
      - "sh:*"
      - "ai:*"
      - "web:*"
      - "agent:aider/ask"
      - "agent:aider/code"
      - "agent:aider/architect"

  - name: "detect_lang"
    display: "Aider"
    description: |
      Identifies the programming language from the user's request or by examining local file systems.
    model: "llm/L1"
    embed:
      - "agent:context/summary"
      - "agent:kbase"
      - "agent:memory"
      # - "agent:think"
    environment:
      language: "go"
    instruction: |
      Determine the user's programming language from their input or by scanning the local file system.
      Use the "sh:set_envs" tool to update the "language" environment variable accordingly.

      Set the detected language using the "set_envs" tool with `language` as the variable name.
      
      You may use "sh:get_envs" to verify.
    functions:
      - "fs:*"
      - "sh:*"
      - "ai:*"

  - name: "ask"
    display: "Aider Ask"
    description: |
      Act as an expert code analyst and answer questions about the supplied code
      Aider will discuss your code and answer questions about it, but never make changes.
    model: "llm/L2"
    environment:
      language: "go"
    embed:
      - agent:aider/detect_lang
    instruction: |
      Act as an expert code analyst.
      Answer questions about the supplied code.
      Always reply to the user in {{.language}}.

      If you need to describe code changes, do so *briefly*.
    functions:
      - "fs:*"
      - "sh:*"
      - "ai:*"

  - name: "architect"
    display: "Aider Architect"
    description: |
      Act as an expert architect engineer and provide direction to your editor engineer.
      An architect model will propose changes and an editor model will translate that proposal into specific file edits.
      Aider will change your files.
    model: "llm/L3"
    environment:
      language: "go"
    embed:
      - "agent:aider/detect_lang"
      - "agent:think"
    instruction: |
      Act as an expert architect engineer and provide direction to your editor engineer.
      Study the change request and the current code.
      Describe how to modify the code to complete the request.
      The editor engineer will rely solely on your instructions, so make them unambiguous and complete.
      Explain all needed code changes clearly and completely, but concisely.
      Just show the changes needed.

      DO NOT show the entire updated function/file/etc!

      Always reply to the user in {{.language}}.
    functions:
      - "fs:*"
      - "sh:*"
      - "ai:*"

  - name: "code"
    display: "Aider Code"
    description: |
      Act as an expert code analyst. Understand the user's question or request, solely to determine ALL the existing sources files which will need to be modified.
      Aider will make changes to your code to satisfy your requests
    model: "llm/L2"
    environment:
      language: "go"
    embed:
      - agent:aider/detect_lang
    instruction: |
      Act as an expert code analyst.
      Understand the user's question or request, solely to determine ALL the existing sources files which will need to be modified.
      Return the *complete* list of files which will need to be modified based on the user's request.
      Explain why each file is needed, including names of key classes/functions/methods/variables.
      Be sure to include or omit the names of files already added to the chat, based on whether they are actually needed or not.

      The user will use every file you mention, regardless of your commentary.
      So *ONLY* mention the names of relevant files.
      If a file is not relevant DO NOT mention it.

      Only return files that will need to be modified, not files that contain useful/relevant functions.

      You are only to discuss EXISTING files and symbols.
      Only return existing files, don't suggest the names of new files or functions that we will need to create.

      Always reply to the user in {{.language}}.

      Be concise in your replies.
      Return:
      1. A bulleted list of files the will need to be edited, and symbols that are highly relevant to the user's request.
      2. A list of classes/functions/methods/variables that are located OUTSIDE those files which will need to be understood. Just the symbols names, *NOT* file names.

      # Your response *MUST* use this format:

      ## ALL files we need to modify, with their relevant symbols:

      - alarms/buzz.py
        - `Buzzer` class which can make the needed sound
        - `Buzzer.buzz_buzz()` method triggers the sound
      - alarms/time.py
        - `Time.set_alarm(hour, minute)` to set the alarm

      ## Relevant symbols from OTHER files:

      - AlarmManager class for setup/teardown of alarms
      - SoundFactory will be used to create a Buzzer
    functions:
      - "fs:*"
      - "sh:*"
      - "ai:*"

###
set: "llm"
provider: "openai"
base_url: "https://api.openai.com/v1/"
api_key: "openai"
# provider: "anthropic"
# base_url: "https://api.anthropic.com/"
# api_key: "anthropic"

# https://aider.chat/docs/llms.html
models:
  L1:
    model: "gpt-5-nano"
    provider: "openai"
    base_url: "https://api.openai.com/v1/"
    api_key: "openai"
  # L2:
  #   model: "claude-sonnet-4-0"
  L2:
    model: "gpt-5-mini"
  # L3:
  #   model: "claude-opus-4-0"
  # o1-mini gpt-4o
  L3:
    model: "o3-mini"
###
