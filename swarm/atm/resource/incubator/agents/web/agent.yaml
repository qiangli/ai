###

pack: web
model: llm/L1
log_level: info
agents:
  - name: "web"
    new: true
    display: "üåç Web Researcher"
    description: |
      Generate clear, structured reports in markdown, using reliable, recent sources 
      and including a detailed reference list.
    embed:
      - "agent:memory"
    instruction:
      content: |
        Evaluate and organize content for research tasks with a focus on relevance, 
        credibility, and quantitative information. Maintain diverse perspectives, 
        avoiding summarization while ensuring comprehensive coverage of up to the 
        maximum number of relevant sources.

        Generate structured, in-depth reports by highlighting key insights, facts, and 
        numbers. Write in markdown format, ensuring clarity with hyperlinks and 
        citations. Prioritize recent and credible sources, using tables for data 
        presentation when necessary. Conclude with a detailed reference list of all 
        utilized source URLs.
    functions:
      - "agent:web/search"
      - "agent:web/research"
      - "agent:web/crawl"
  
  - name: "web/search"
    display: "Web Search"
    description: "Get web search results for a given query."
    instruction:
      content: |
        As a web search assistant, you are responsible for processing user queries and providing accurate
        search results from the web. When a user submits a query, analyze the main components of the query,
        perform a web search, and return the most relevant results.
    parameters:
      type: "object"
      properties:
        query:
          type: "string"
          description: "The search query string"
        max_results:
          type: "integer"
          description: "Maximum number of results to return"
          default: 5
          minimum: 1
          maximum: 10
      required:
        - query
    functions:
      - "ddg:*"
      - "bing:*"
      - "google:*"
      - "brave:*"
  
  - name: "web/research"
    display: "Planning the research strategy and subtasks"
    description: "Generate sub queries based on user input"
    model: llm/L3
    arguments:
      reasoning_effort: medium
      max_iterations: 3
    parameters:
      type: "object"
      properties:
        query:
          type: "string"
          description: "The research query string to generate sub queries for"
        max_iterations:
          type: "integer"
          description: "Maximum number of search queries to search online that form an objective opinion."
          default: 3
          minimum: 1
          maximum: 5
      required:
        - query
    instruction:
      content: |
        #! --mime-type=x-go-template
        You are a seasoned research assistant tasked with generating search queries to find relevant information for the following task:
        
        Context: {{.query}}

        Use this context to inform and refine your search queries. The context provides real-time web information
        that can help you generate more specific and relevant queries. Consider any current events, recent developments,
        or specific details mentioned in the context that could enhance the search queries.

        Write {{.max_iterations}} search queries to search online that form an objective opinion.

        Assume the current date is {{now}} if required.

        You must respond with a list of strings in the following JSON array object format:
          [
            "query 1",
            "query 2",
            ...
          ]
        The response should contain ONLY the list.
    
  # - name: "web/scrape"
  #   display: "Scraper"
  #   description: "Runs a query across multiple retrievers and scrapes the resulting URLs."
  #   parameters:
  #     type: "object"
  #     properties:
  #       sub_queries:
  #         type: "string"
  #         description: "list of sub query strings in JSON format"
  #   instruction:
  #     content: |
  #         Please verify if the input query is a list of strings in JSON format.
  #         If it is, simply return it. If not, format the input into a JSON list of strings.
  #         Ensure there is no other content in the response, as the subsequent process will parse it strictly as JSON.
  #   flow:
  #     type: map
  #     concurrency: 3
  #     actions:
  #       - "agent:web/crawl"
  #   functions:
  #     - "agent:web/crawl"
  
  - name: "web/crawl"
    new: true
    display: "Crawler"
    description: "Runs a query across multiple retrievers and scrapes the resulting URLs."
    arguments:
      maximum_attempts: 5
    parameters:
      type: "object"
      properties:
        query:
          type: "string"
          description: "The query string to crawl"
        maximum_attempts:
          type: "integer"
          description: "The maximum attempts allowed"
          default: 3
          minimum: 1
          maximum: 5
      required:
        - query
    instruction:
      content: |
        #! --mime-type=text/x-go-template
        You are a specialized web crawler. The maximum attempts allowed are {{.maximum_attempts}}.
        For each query, execute a search and follow only the immediate links one level deep.
        If the fetch returns empty results or errors, continue with more search and fetch tool calls.
        Collect and merge the content from these pages to provide comprehensive information 
        relevant to the user query.
    functions:
      - "agent:web/search"
      - "web:*"

## models
set: llm
provider: "openai"
base_url: "https://api.openai.com/v1/"
api_key: "openai"
models:
  L1:
    model: "gpt-4o-mini"
  L2:
    model: "gpt-4.1"
  L3:
    model: "o4-mini"
###